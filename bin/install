#!/usr/bin/env bash

set -eu

REPOSITORY_NAME="dotfiles"
SOURCE_CODE_REPOSITORY="git@github.com:artifactsauce/$REPOSITORY_NAME.git"
[ "${DEPLOY_DIRECTORY:-UNDEF}" = "UNDEF" ] && DEPLOY_DIRECTORY=$(pwd)

if [ -d "$DEPLOY_DIRECTORY/$REPOSITORY_NAME" ]; then
    echo "Already exists: $DEPLOY_DIRECTORY/$REPOSITORY_NAME"
    exit 1
fi

git clone $SOURCE_CODE_REPOSITORY $DEPLOY_DIRECTORY/$REPOSITORY_NAME

cd $DEPLOY_DIRECTORY/$REPOSITORY_NAME
git submodule init
git submodule update
bash ./bin/init
